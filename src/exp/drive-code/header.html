<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/2.1.2/TweenMax.min.js" aysnc="true"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/2.1.2/TimelineLite.min.js" aysnc="true"></script>
<script>
  Y.on('available', function () {
    Y.one('body').prepend(
      '<div class="loading-screen"><div><img class="loading-logo" src="https://lukemoderwell.com/drive-loader.b3b24274.gif"><p class="loading-text">loading</p></div></div><div class="loading-swiper"></div>'
    ).setStyle("display", "block");

    function animateIntro() {
      // swipe in
      TweenMax.to('.loading-swiper', .75, {
        height: '100%',
        y: 0,
        delay: .5,
        ease: Power1.easeIn
      });

      // swipe out
      TweenMax.to('.loading-swiper', .75, {
        height: 0,
        top: 0,
        y: '-100%',
        zIndex: 0,
        delay: 1.25,
        ease: Power1.easeOut
      });

      // remove loading bg
      TweenMax.to('.loading-screen', 0, {
        display: 'none',
        pointerEvents: 'none',
        zIndex: 0,
        delay: 1.35
      });

      // show main text 
      TweenMax.to('.video-caption', .75, {
        opacity: 1,
        y: 0,
        delay: 2,
        ease: Power1.easeOut
      });

      //  header reveal
      var headerClass = window.innerWidth < 640 ? '.Mobile-bar--top' : '.Header--bottom';
      TweenMax.to(headerClass, .75, {
        position: 'absolute',
        zIndex: 1,
        delay: 2
      });

      // spring reveal feat cards
      TweenMax.to('.video-wrapper', 1, {
        height: '65vh',
        overflow: 'hidden',
        delay: 4,
        ease: Power2.easeOut
      });
    }

    function checkVideoState() {
      var v = document.querySelector('.video-poster');
      var i = setInterval(function () {
        console.log('waiting on video load');
        if (v.readyState > 3) {
          // logo fade out
          Y.one(".loading-screen").addClass('loaded');
          // add header classes to get white text
          Y.one(".Header--bottom").addClass('Header--index-gallery Header--overlay');
          animateIntro();
          clearInterval(i);
        }
      }, 500);
    }
    checkVideoState();
  }, 'body');
</script>
<style>
  @keyframes fadeIn {
    from {
      opacity: 0;
      transform: translateY(15%);
    }

    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  body {
    display: none;
  }

  .loading-screen {
    display: flex;
    align-items: center;
    justify-content: center;
    position: fixed;
    width: 100%;
    height: 100%;
    top: 0;
    background-color: #303643;
    z-index: 100001;
    transition: .45s all ease-in-out;
    overflow: hidden;
  }

  .loading-logo {
    width: 250px;
    height: 250px;
  }

  .loading-text {
    margin: 0;
    text-align: center;
    font-size: .75rem;
    text-transform: uppercase;
    letter-spacing: 2px;
    color: white;
    transform: translateY(-50px)
  }

  .loading-logo,
  .loading-text {
    transition: .5s all ease-in-out;
  }

  .loading-swiper {
    position: absolute;
    bottom: 0;
    width: 100%;
    height: 0;
    transform: translateY(100%);
    background-color: #E49417;
    z-index: 999999;
  }

  .loaded .loading-logo,
  .loaded .loading-text {
    opacity: 0;
    transform: translateY(15%);
  }
</style>
